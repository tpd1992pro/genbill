<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Bill Image Generator</title>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>

<body style="background:#f2f2f2;">

<div id="billBox" style="
    width: 320px;
    padding: 20px;
    margin: 40px auto;
    border-radius: 16px;
    background: white;
    border: 2px solid #dcdcdc;
    font-family: sans-serif;
    white-space: pre-wrap;
    font-size: 16px;
    line-height: 1.5;
"></div>

<script>
const params = new URLSearchParams(window.location.search);

const raw = params.get("text") || "";
const text = decodeURIComponent(raw.replace(/\+/g, " "));
document.getElementById("billBox").innerText = text;

setTimeout(() => {
    html2canvas(document.getElementById("billBox")).then(canvas => {
        canvas.toBlob(async blob => {
            try {
                await navigator.clipboard.write([
                    new ClipboardItem({ "image/png": blob })
                ]);
                alert("✔ Ảnh đã copy vào clipboard!");
                window.close();
            } catch (err) {
                alert("❌ Không thể copy ảnh: " + err);
            }
        });
    });
}, 500);
</script>

</body>
</html>
