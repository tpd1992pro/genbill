<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Bill Image Generator</title>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>

<body style="background:#f2f2f2;">

<!-- BILL FORM (ĐẸP + LOGO) -->
<div id="billBox" style="
    width: 360px;
    padding: 20px;
    margin: 40px auto;
    border-radius: 18px;
    background: #ffffff;
    border: 2px solid #e5e5e5;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    font-family: 'Segoe UI', sans-serif;
    white-space: pre-wrap;
    font-size: 16px;
    line-height: 1.6;
    color: #333;
    position: relative;
">

    <!-- LOGO BIGO MINI -->
    <div style="text-align:center; margin-bottom:10px;">
        <img src="http://27.71.27.173/api/bigo.png" 
             style="width:70px; height:auto;">
        <div style="font-weight:600; margin-top:4px; color:#00bcd4;">
            BILL THANH TOÁN BIGO
        </div>
    </div>

    <!-- Nội dung bill sẽ được chèn vào đây -->
    <div id="billText"></div>

</div>


<script>
const params = new URLSearchParams(window.location.search);

// Lấy text từ URL
const raw = params.get("text") || "";
const text = decodeURIComponent(raw.replace(/\+/g, " "));

// Đổ text vào vùng #billText thay vì billBox
document.getElementById("billText").innerText = text;

// Chờ giao diện load xong rồi xuất ảnh
setTimeout(() => {
    html2canvas(document.getElementById("billBox")).then(canvas => {
        canvas.toBlob(async blob => {
            try {
                await navigator.clipboard.write([
                    new ClipboardItem({ "image/png": blob })
                ]);
                alert("✔ Ảnh đã copy vào clipboard!");
                window.close();
            } catch (err) {
                alert("❌ Không thể copy ảnh: " + err);
            }
        });
    });
}, 300);
</script>

</body>
</html>
